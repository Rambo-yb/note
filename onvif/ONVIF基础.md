### 一、ONVIF协议概述
#### 1.ONVIF
ONVIF（Open Network Video Interface Forum，开放式网络视频接口论坛）是一个全球性的开放式行业论坛，其目标是促进开发和使用基于物理IP的安全产品接口的全球开放标准。ONVIF创建了一个视频监控和其他物理安全领域的IP产品如何进行相互通信的标准。ONVIF是由Axis Communications，博世安防系统和索尼于2008年创立的。

2008年11月25日，ONVIF正式成为非营利性组织，501(c)6 特拉华州。会员资格面向制造商，软件开发商，顾问，系统集成商，终端用户和其他希望参与ONVIF活动的利益集团开放。ONVIF规范旨在实现跨生产商的网络物理安全产品之间的互操作性。 

ONVIF是一个开放的安防行业组织，致力于为安防行业提供和促进标准化开放接口，以实现IP网络安防产品的有效互操作性。

#### 2.名词介绍
##### 1)RPC
RPC（Remote Procedure Call, 远程过程调用）是一种通信协议，它允许程序调用在另一台计算机上的函数或方法，就如同调用本地计算机上的函数或方法一样。RPC机制隐藏了底层网络通信的细节，使得开发者可以专注于业务逻辑的实现。

##### 2)SOAP
SOAP（Simple Object Access Protocol，简单对象访问协议）是一种基于 XML 的消息传递协议，主要用于在分布式网络环境中实现不同系统之间的通信。SOAP 常用于 Web 服务中，因为它能够在不同平台、不同编程语言的系统之间传输结构化数据

soap协议=rpc原理+http传输协议+xml数据化格式

##### 3)WSDL
WSDL（Web Services Description Language，Web 服务描述语言）是一种基于 XML 的文档格式，用于描述 Web 服务的功能、接口、操作以及如何与其进行通信。WSDL 通常用于定义基于 SOAP 协议的 Web 服务，使得客户端可以通过解析 WSDL 文档，了解服务的接口、参数和数据结构，进而与服务交互。

##### 4)WebServices
Web Services是一种基于互联网的服务技术，用于不同应用之间进行数据交换和功能调用。Web 服务通常采用开放的标准和协议，例如 XML、SOAP、WSDL 和 HTTP，以实现跨平台和跨语言的系统互操作性。

#### 3.ONVIF框架
![[Pasted image 20250811093916.png]]

#### 4.ONVIF优势
* **跨品牌兼容性**：ONVIF 框架定义了标准化的服务接口，实现了不同品牌设备之间的无缝互操作性。
* **模块化扩展**：框架的模块化设计，使用户可根据需求启用或定制特定功能模块。
* **数据安全性**：提供身份验证和权限控制，确保设备数据和操作的安全性。

### 二、ONVIF功能
#### 1.设备管理
http://www.onvif.org/ver10/network/wsdl/remotediscovery.wsdl

http://www.onvif.org/ver10/device/wsdl/devicemgmt.wsdl

* 提供设备发现接口，支持通过 WS-Discovery 协议自动发现网络中的 ONVIF 设备
* 提供基本的设备管理功能，如设备发现、网络配置、时间设置、用户管理等
* 包含设备的基本信息接口，允许客户端获取设备的版本、序列号、固件版本等基本信息
* 支持用户权限管理，确保只有授权用户能够访问设备

#### 2.媒体服务
http://www.onvif.org/ver10/media/wsdl/media.wsdl

http://www.onvif.org/ver20/media/wsdl/media.wsdl

* 提供视频和音频流的配置和获取接口，包括视频编码格式、分辨率、帧率、比特率等参数
* 包括图像设置功能，如亮度、对比度、饱和度等
* 支持获取视频流的 URI（通过 RTSP 传输），使得客户端能够实时观看视频
* 支持获取抓拍的URI（通过HTTP传输），客户端获取抓拍图片

#### 3.云台服务
http://www.onvif.org/ver20/ptz/wsdl/ptz.wsdl

* 提供摄像头的云台控制接口，支持摄像头的平移（Pan）、倾斜（Tilt）和缩放（Zoom）操作
* 允许客户端控制摄像头的视角，适用于带有 PTZ 功能的摄像头
* 支持预设点（Preset）管理，客户端可以设定和调用预设的视角位置

#### 4.图像服务
http://www.onvif.org/ver20/imaging/wsdl/imaging.wsdl

* 提供对摄像头图像设置的控制，如色彩、锐度、白平衡、宽动态范围等。
* 支持动态调整图像设置，以应对不同的环境光照和成像需求。

#### 5.事件管理
http://www.onvif.org/ver10/events/wsdl/event.wsdl

* 用于管理和接收设备事件和报警通知，如运动检测、遮挡检测、设备故障等。
* 支持事件订阅和通知，客户端可以订阅特定类型的事件并接收通知。
* 事件服务使用推送方式（基于 SOAP）向订阅的客户端发送事件消息。

#### 6.录像管理
* 用于控制录像存储、查询和回放功能，支持本地或网络存储。
* 提供对录像的开始、暂停、停止、查询、回放等操作接口，便于用户管理历史录像。

#### 7.视频分析
* 支持智能分析功能，如人数统计、区域检测、物体识别等（具体功能因设备支持而异）。
* 提供图像或视频流的实时分析，适用于有高级分析需求的监控应用。

### 三、onvif开发
#### 1.开发依赖
![[Pasted image 20250811093858.png]]

#### 2.开发流程
![[Pasted image 20250811093701.png]]

#### 3.调试工具
**ONVIF Device Manager**：是一款专为网络视频设备管理而设计的强大工具。它不仅支持网络视频传输器（NVT）、网络视频存储（NVS）和网络视频分析（NVA）设备的管理，还提供了全面的设备发现、媒体流处理、成像控制、分析服务、事件处理以及PTZ（云台、变焦、变焦）服务的支持。

**ONVIF Device Test Tool**：是一款由 ONVIF 官方提供的测试工具，专门用于验证网络视频设备是否符合 ONVIF 标准。该工具旨在帮助设备制造商和开发人员确保设备的各项功能符合 ONVIF 的规范要求，使设备能够在多品牌、多平台环境中实现兼容性和互操作性。